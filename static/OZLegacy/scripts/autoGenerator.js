var autoGenerator=new Object();var groupArray=new Array();var rawData;var metadata;function onloadSelections(g){var d=document.getElementById(g);for(var c=0;c<selections.length;c++){var f=createSection(d,selections[c]);var e=selections[c].visible;for(var b=0;b<e.length;b++){createComponent(f,e[b],0)}var a=selections[c].additional;for(var b=0;b<a.length;b++){createComponent(f,a[b],1)}createAdditionalChoice(f,selections[c].additional,selections[c].visible)}$("[id$=_minus_button]").parent().hide();createSubmitButton(d);createAutoGeneratedURL(d);loadData()}function loadData(){autoGenerator.name=$("#selected_group").find(":selected").attr("data");groupArray.push(autoGenerator.name);$("#selected_group").change(function(){var a=$("#selected_group").find(":selected").attr("data");if(a==autoGenerator.name){return}else{if(a=="plants"&&autoGenerator.name!="plants"){var b=document.getElementById("useroption");if(b){b.parentNode.removeChild(b)}var c=document.createElement("script");c.setAttribute("id","useroption");c.src="user/userOptions_plants.js";document.head.appendChild(c)}else{if(a!="plants"&&autoGenerator.name=="plants"){var b=document.getElementById("useroption");if(b){b.parentNode.removeChild(b)}var c=document.createElement("script");c.setAttribute("id","useroption");c.src="user/userOptions.js";document.head.appendChild(c)}}file_name=a;init();autoGenerator.name=a}})}function createAdditionalChoice(f,b,e){var a=$("<select></select").attr("id","select_additional_"+$(f).attr("id").substring(11)).append("<option>More...</option>").appendTo(f);var d;for(var c=0;c<b.length;c++){if(typeof b[c].display_name=="undefined"){d=b[c].name}else{d=b[c].display_name}$("<option>"+d+"</option>").attr("data",b[c].name).appendTo(a)}$(a).change(function(){add_option($(this))});if($(a).children("option").length==1){$(a).hide()}}function add_option(a){if($(a).prop("selectedIndex")==0){return}$("[id=_input_"+$(a).find(":selected").attr("data")+"_div]").show();if($(a).parent().attr("id")=="select_div_colours"){$("option[value=-1]").prop("selected","selected")}$(a).children("option:selected").remove();if($(a).children("option").length==1){$(a).hide()}}function createAutoGeneratedURL(c){var a=$('<fieldset id="url_generator"></fieldset>').appendTo(c);var b=$("<label>URL: copy to your address bar</label>").appendTo(a);$('<div id="url" style="padding:0.3em 0.1em" ></div>').append('<textarea rows="3"  id="autoURL"></textarea>').appendTo(b);b=$("<label>Embed: copy to your html page</label>").appendTo(a);$('<div id="iframe" style="padding:0.3em 0.1em" ></div>').append('<textarea rows="3"  id="autoIframe"></textarea>').appendTo(b);b=$("<label>Link: copy to your html page</label>").appendTo(a);$('<div id="Link" style="padding:0.3em 0.1em" ></div>').append('<textarea rows="3"  id="autoLink"></textarea>').appendTo(b)}function createSubmitButton(a){var b=document.createElement("button");b.innerHTML="Try it!";b.id="submitBtn";b.type="button";a.appendChild(b);b.addEventListener("click",function(){setnewurl(a);generateURL();animation_status=-1;init()},false);$(a).append("<br></br>")}function generateURL(){var b="http://www.onezoom.org/"+autoGenerator.name+".htm?"+window.location.hash.substring(1);var a="http://www.onezoom.org/embeded_"+autoGenerator.name+".htm?"+window.location.hash.substring(1);$("#autoURL").val(b);$("#autoLink").val('<a href="'+b+'">OneZoom</a>');$("#autoIframe").val('<iframe width="640" height="400" src="'+a+'"></iframe>')}function setnewurl(d){var c="";var a="";for(var b=0;b<d.length;b++){if(d[b].id.indexOf("_input")==0){a="";if($(d[b]).is("[data_url]")){a+=$(d[b]).attr("data_url")}else{a+=d[b].name}if(d[b].type=="radio"&&d[b].checked){c+=a+"="+d[b].value+"&"}else{if(d[b].type=="checkbox"&&d[b].checked){c+=a+"=1&"}else{if(d[b].type=="checkbox"&&!d[b].checked){c+=a+"=2&"}else{if(d[b].type=="text"&&d[b].value!=""){c+=a+"="+d[b].value.split(" ").join("%20")+"&"}else{if(d[b].tagName=="SELECT"){c+=a+"="+d[b].options[d[b].selectedIndex].value.split(" ").join("%20")+"&"}}}}}}}var e=$("input[id=_input_name]");if($(e).val()!=""){c+="text=link%20to%20"+$(e).val().split(" ").join("%20")+"&"}c=c.replace("&colour=-1","");window.location.hash=c.substring(0,c.length-1)}function createSection(c,d){var e;if(typeof d.display_name=="undefined"){e=d.name}else{e=d.display_name}var a=$("<fieldset></fieldset>").attr("id","select_fieldset").append("<legend>"+e+"</legend>").appendTo(c);var b=$("<div></div>").attr("id","select_div_"+d.name).appendTo(a);return b}function createComponent(e,b,a){var c;if(b.type=="radio"){c=createRadio(e,b,a)}else{if(b.type=="checkbox"){c=createCheckbox(e,b,a)}else{if(b.type=="text"){c=createTextField(e,b,a)}else{if(b.type=="select"){c=createDropList(e,b,a)}else{if(b.type=="color"){c=createColorPicker(e,b,a)}else{if(b.type=="combination"){c=createCombination(e,b,a)}}}}}}if(a){var d;if(typeof b.display_name=="undefined"){d=b.name}else{d=b.display_name}$("<button>-</button>").attr("type","button").attr("id","_input_"+b.name+"_minus_button").attr("data",b.name).attr("option_val",d).click(function(g){$(this).parent().hide();
var f=$(this).parent().parent().find("[id^=select_additional]");$(f).show();$(f).append('<option data="'+$(this).attr("data")+'">'+$(this).attr("option_val")+"</option>")}).appendTo(c)}}function addminusButton(b,a){$("<button>-</button>").attr("type","button").attr("id","_input_"+a.name+"_minus_button").click(function(){addToAdditional(b,a);deleteFromVisible(b,a)}).insertBefore($(b).children("[id^=select_additional]"))}function addToAdditional(d,a){var c;for(var b=0;b<selections.length;b++){if(selections[b].name==$(d).attr("id").substring(11)){c=selections[b]}}if(c==undefined){return}c.additional.push(a);$("<option>"+a.name+"</option>").attr("name",a.name).appendTo($(d).children("[id^=select_additional]"));$(d).children("[id^=select_additional]").next("button").andSelf().show()}function deleteFromVisible(e,a){var c="";var d=a.name.split(" ");if(d.length==1){c=d}else{for(var b=0;b<d.length;b++){c+=a.name.split(" ")[b];if(b!=d.length-1){c+="\\ "}}}$(e).children("[id^=_input_"+c+"]").remove()}function createCombination(h,e,c){var g=$('<div id="_input_'+e.name+'_div"></div>').appendTo(h);var b=$("<fieldset><legend>"+e.name+"</legend></fieldset>").appendTo(g);var a=$("<select></select>").attr("id","_select_combination_"+e.name).attr("name",e.name).appendTo($(b));var d=e.options;for(var f=0;f<d.length;f++){$("<option>"+d[f].name+"</option>").appendTo(a)}createCombinationOption(e,b,0);$(a).change(function(){deleteCombinationOption(b);createCombinationOption(e,b,$(a).prop("selectedIndex"))})}function createCombinationOption(d,a,c){var b=d.options[c].options;for(var e=0;e<b.length;e++){createComponent(a,b[e],false)}}function deleteCombinationOption(a){$(a).children("[id^=_input]").remove()}function createColorPicker(g,c,b){var e=$('<div id="_input_'+c.name+'_div"></div>').appendTo(g);var a=$("<input></input>").attr("id","_input_"+c.name).attr("type","text").attr("name",c.name).attr("data",c.change).appendTo(e);var f;if(typeof c.display_name=="undefined"){f=c.name}else{f=c.display_name}$("<label>"+f+" </label>").attr("id",$(a).attr("id")).attr("name",c.name).appendTo(e);$(a).spectrum({color:c.original,move:function(h){$(this).spectrum("set",h);var i=hexToRgb(h.toHexString());var j="rgb("+i.r+","+i.g+","+i.b+")";$(this).val(j);FunctionMap($(this).attr("data"),j)},});$(a).next("[class^=sp-replace]").attr("id","_input_"+c.name);var d=$("<button>Reset</button>").attr("id","_input_"+c.name+"_reset_btn").attr("type","button").attr("data",c.change).val(c.original).insertAfter($(a));$(d).click(function(){$(a).val($(this).val());$(a).spectrum({color:c.original,move:function(h){$(this).spectrum("set",h);var i=hexToRgb(h.toHexString());var j="rgb("+i.r+","+i.g+","+i.b+")";$(this).val(j);FunctionMap($(this).attr("data"),j)},});$(a).next("[class^=sp-replace]").attr("id","_input_"+c.name);FunctionMap($(this).attr("data"),$(this).val())});$(a).next("[class^=sp-repla]").attr("id","_input_"+c.name);if(c.urlname!=undefined){a.attr("data_url",c.urlname)}return e}function createRadio(h,e,a){var g=$('<div id="_input_'+e.name+'_div"></div>').appendTo(h);var d=e.options;for(var f=0;f<d.length;f++){var c=$("<label>"+d[f].name+"</label>").attr("id",$(b).attr("id")).attr("class","radio-inline ").appendTo(g);var b=$("<input></input>").attr("id","_input_"+e.name).attr("type","radio").val(d[f].value).attr("name",e.name).attr("data",d[f].click);$(c).prepend(b);if(e.urlname!=undefined){b.attr("data_url",e.urlname)}if(d[f].checked!=null&&d[f].checked=="true"){$(b).prop("checked",true)}if(d[f].click!=null){$(b).click(function(){FunctionMap($(this).attr("data"),$(this).val())})}}return g}function createCheckbox(g,c,a){var e=$('<div id="_input_'+c.name+'_div"></div>').appendTo(g);var b=c.options;for(var d=0;d<b.length;d++){var f=$("<input></input>").attr("type","checkbox").attr("id","_input_"+c.name).attr("name",c.name).attr("data",b[d].click).appendTo(e);if(c.urlname!=undefined){f.attr("data_url",c.urlname)}if(b[d].checked!=null&&b[d].checked=="true"){$(f).prop("checked",true)}$(f).click(function(){FunctionMap($(this).attr("data"),$(this).val())});$("<label>"+b[d].name+" </label>").attr("id",$(f).attr("id")).insertAfter(f)}return e}function createTextField(f,b,a){var c=$('<div id="_input_'+b.name+'_div"></div>').appendTo(f);var e=$("<input></input>").attr("id","_input_"+b.name).attr("type","text").attr("name",b.name).appendTo(c);if(b.urlname!=undefined){e.attr("data_url",b.urlname)}var d;if(typeof b.display_name=="undefined"){d=b.name}else{d=b.display_name}$("<label>"+d+" </label>").attr("id",$(e).attr("id")).attr("name",b.name).insertAfter(e);return c}function createDropList(b,f,e){var a=$('<div id="_input_'+f.name+'_div"></div>').appendTo(b);var g=$("<select></select>").attr("id","_input_"+f.name).attr("name",f.name).attr("data",f.change).appendTo(a);if(f.urlname!=undefined){g.attr("data_url",f.urlname)}var j=f.options;for(var c=0;c<j.length;c++){var d=$("<option>"+j[c].name+"</option>").val(j[c].value).appendTo(g);if(typeof j[c].disable!="undefined"&&j[c].disable=="true"){$(d).prop("disabled",true)
}}$(g).change(function(){FunctionMap($(this).attr("data"),$(this).val())});var h;if(typeof f.display_name=="undefined"){h=f.name}else{h=f.display_name}$("<label>"+h+" </label>").attr("id",$(g).attr("id")).attr("name",f.name).insertAfter(g);return a}function reloadIframe(c){var b=document.getElementById("init_type").value;var a=document.getElementById(c).src;a=a+"init="+b;document.getElementById(c).src=a;document.getElementById(c).src=document.getElementById(c).src}function addNewFeature(){var a=document.getElementById("new_feature");var b=a.selectedIndex;var c=a.options[b].innerHTML;addNewRow(c);a.remove(b)}function addNewRow(d){var e=document.createElement("div");e.className="row";var c=document.createElement("div");c.className="large-12 columns";var b=document.createElement("label");b.innerHTML=d;var a=document.createElement("select");e.appendChild(c);c.appendChild(b);c.appendChild(a);document.getElementById("form").insertBefore(e,document.getElementById("tryit"))};